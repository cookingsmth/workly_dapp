"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/settings";
exports.ids = ["pages/api/settings"];
exports.modules = {

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("jsonwebtoken");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(api)/./pages/api/settings.ts":
/*!*******************************!*\
  !*** ./pages/api/settings.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__);\n// pages/api/settings.ts\n\n\n\n// Пути к файлам\nconst getUsersFilePath = ()=>path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), \"data\", \"users.json\");\nconst getSettingsFilePath = ()=>path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), \"data\", \"settings.json\");\n// Функции для работы с файлами\nconst loadUsers = ()=>{\n    const filePath = getUsersFilePath();\n    if (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(filePath)) {\n        return [];\n    }\n    try {\n        const data = fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(filePath, \"utf8\");\n        return JSON.parse(data);\n    } catch (error) {\n        console.error(\"Error loading users:\", error);\n        return [];\n    }\n};\nconst loadSettings = ()=>{\n    const filePath = getSettingsFilePath();\n    if (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(filePath)) {\n        return [];\n    }\n    try {\n        const data = fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(filePath, \"utf8\");\n        return JSON.parse(data);\n    } catch (error) {\n        console.error(\"Error loading settings:\", error);\n        return [];\n    }\n};\nconst saveSettings = (settings)=>{\n    const filePath = getSettingsFilePath();\n    const dir = path__WEBPACK_IMPORTED_MODULE_1___default().dirname(filePath);\n    if (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(dir)) {\n        fs__WEBPACK_IMPORTED_MODULE_0___default().mkdirSync(dir, {\n            recursive: true\n        });\n    }\n    fs__WEBPACK_IMPORTED_MODULE_0___default().writeFileSync(filePath, JSON.stringify(settings, null, 2));\n};\n// Проверка токена\nconst verifyToken = (token)=>{\n    try {\n        const decoded = jsonwebtoken__WEBPACK_IMPORTED_MODULE_2___default().verify(token, process.env.JWT_SECRET || \"workly-local-secret-key-2025\");\n        return decoded;\n    } catch (error) {\n        return null;\n    }\n};\nconst getUserFromToken = (authHeader)=>{\n    if (!authHeader || !authHeader.startsWith(\"Bearer \")) {\n        return null;\n    }\n    const token = authHeader.split(\" \")[1];\n    const decoded = verifyToken(token);\n    if (!decoded) return null;\n    try {\n        const users = loadUsers();\n        const user = users.find((u)=>u.id === decoded.userId);\n        if (!user) return null;\n        return {\n            id: user.id,\n            username: user.username,\n            email: user.email,\n            createdAt: user.createdAt\n        };\n    } catch (error) {\n        return null;\n    }\n};\n// Создание дефолтных настроек\nconst createDefaultSettings = (user)=>{\n    return {\n        id: user.id,\n        email: user.email,\n        name: user.username || user.name || \"\",\n        username: user.username,\n        notifications: {\n            email: true,\n            push: true,\n            newTasks: true,\n            taskUpdates: true,\n            messages: true,\n            marketing: false\n        },\n        privacy: {\n            profileVisibility: \"public\",\n            showEmail: false,\n            showStats: true,\n            showCompletedTasks: true\n        },\n        preferences: {\n            theme: \"dark\",\n            language: \"en\",\n            timezone: \"UTC\",\n            currency: \"USD\"\n        },\n        createdAt: user.createdAt || new Date().toISOString()\n    };\n};\nasync function handler(req, res) {\n    const { method } = req;\n    // Проверяем аутентификацию\n    const currentUser = getUserFromToken(req.headers.authorization);\n    if (!currentUser) {\n        return res.status(401).json({\n            error: \"Unauthorized\",\n            message: \"Authentication required\"\n        });\n    }\n    if (method === \"GET\") {\n        try {\n            // Загружаем настройки\n            const allSettings = loadSettings();\n            let userSettings = allSettings.find((settings)=>settings.id === currentUser.id);\n            // Если настроек нет, создаем дефолтные\n            if (!userSettings) {\n                userSettings = createDefaultSettings(currentUser);\n                allSettings.push(userSettings);\n                saveSettings(allSettings);\n            }\n            res.status(200).json(userSettings);\n        } catch (error) {\n            console.error(\"Get settings error:\", error);\n            res.status(500).json({\n                error: \"Internal server error\",\n                message: \"Failed to get settings\"\n            });\n        }\n    } else if (method === \"PUT\") {\n        try {\n            // Обновляем настройки\n            const updates = req.body;\n            const allSettings = loadSettings();\n            const settingsIndex = allSettings.findIndex((settings)=>settings.id === currentUser.id);\n            // Валидация username на уникальность (если изменился)\n            if (updates.username) {\n                const users = loadUsers();\n                const existingUser = users.find((u)=>u.username === updates.username.toLowerCase() && u.id !== currentUser.id);\n                if (existingUser) {\n                    return res.status(400).json({\n                        error: \"Username already taken\",\n                        message: \"This username is already in use by another user\"\n                    });\n                }\n            }\n            if (settingsIndex === -1) {\n                // Создаем новые настройки если не существуют\n                const newSettings = {\n                    ...createDefaultSettings(currentUser),\n                    ...updates,\n                    id: currentUser.id,\n                    email: currentUser.email,\n                    updatedAt: new Date().toISOString()\n                };\n                allSettings.push(newSettings);\n                saveSettings(allSettings);\n                return res.status(201).json(newSettings);\n            } else {\n                // Обновляем существующие настройки\n                allSettings[settingsIndex] = {\n                    ...allSettings[settingsIndex],\n                    ...updates,\n                    id: currentUser.id,\n                    email: currentUser.email,\n                    updatedAt: new Date().toISOString()\n                };\n                saveSettings(allSettings);\n                // Если обновился username, нужно также обновить его в users.json\n                if (updates.username && updates.username !== currentUser.username) {\n                    const users = loadUsers();\n                    const userIndex = users.findIndex((u)=>u.id === currentUser.id);\n                    if (userIndex !== -1) {\n                        users[userIndex].username = updates.username.toLowerCase();\n                        const usersFilePath = getUsersFilePath();\n                        fs__WEBPACK_IMPORTED_MODULE_0___default().writeFileSync(usersFilePath, JSON.stringify(users, null, 2));\n                    }\n                }\n                res.status(200).json(allSettings[settingsIndex]);\n            }\n        } catch (error) {\n            console.error(\"Update settings error:\", error);\n            res.status(500).json({\n                error: \"Internal server error\",\n                message: \"Failed to update settings\"\n            });\n        }\n    } else if (method === \"DELETE\") {\n        try {\n            // Удалить аккаунт пользователя\n            const { confirmPassword } = req.body;\n            if (!confirmPassword || confirmPassword !== \"DELETE_MY_ACCOUNT\") {\n                return res.status(400).json({\n                    error: 'Please type \"DELETE_MY_ACCOUNT\" to confirm account deletion'\n                });\n            }\n            // Удаляем все данные пользователя из всех файлов\n            const userId = currentUser.id;\n            // Удаляем из users.json\n            const users = loadUsers();\n            const filteredUsers = users.filter((u)=>u.id !== userId);\n            fs__WEBPACK_IMPORTED_MODULE_0___default().writeFileSync(getUsersFilePath(), JSON.stringify(filteredUsers, null, 2));\n            // Удаляем из settings.json\n            const allSettings = loadSettings();\n            const filteredSettings = allSettings.filter((s)=>s.id !== userId);\n            saveSettings(filteredSettings);\n            // Удаляем из других файлов если они существуют\n            const dataDir = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), \"data\");\n            const filesToCheck = [\n                \"profiles.json\",\n                \"tasks.json\",\n                \"applications.json\",\n                \"messages.json\",\n                \"notifications.json\"\n            ];\n            filesToCheck.forEach((fileName)=>{\n                const filePath = path__WEBPACK_IMPORTED_MODULE_1___default().join(dataDir, fileName);\n                if (fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(filePath)) {\n                    try {\n                        const data = JSON.parse(fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(filePath, \"utf8\"));\n                        let filteredData;\n                        switch(fileName){\n                            case \"tasks.json\":\n                                filteredData = data.filter((item)=>item.createdBy !== userId);\n                                break;\n                            case \"applications.json\":\n                                filteredData = data.filter((item)=>item.userId !== userId);\n                                break;\n                            case \"messages.json\":\n                                filteredData = data.filter((item)=>item.senderId !== userId && item.receiverId !== userId);\n                                break;\n                            case \"notifications.json\":\n                                filteredData = data.filter((item)=>item.userId !== userId);\n                                break;\n                            default:\n                                filteredData = data.filter((item)=>item.id !== userId);\n                        }\n                        fs__WEBPACK_IMPORTED_MODULE_0___default().writeFileSync(filePath, JSON.stringify(filteredData, null, 2));\n                    } catch (error) {\n                        console.error(`Error cleaning ${fileName}:`, error);\n                    }\n                }\n            });\n            res.status(200).json({\n                success: true,\n                message: \"Account deleted successfully\"\n            });\n        } catch (error) {\n            console.error(\"Delete account error:\", error);\n            res.status(500).json({\n                error: \"Internal server error\",\n                message: \"Failed to delete account\"\n            });\n        }\n    } else {\n        res.status(405).json({\n            error: \"Method not allowed\",\n            message: `Method ${method} is not supported`\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvc2V0dGluZ3MudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBLHdCQUF3QjtBQUVMO0FBQ0k7QUFDTztBQXNDOUIsZ0JBQWdCO0FBQ2hCLE1BQU1HLG1CQUFtQixJQUFNRixnREFBUyxDQUFDSSxRQUFRQyxHQUFHLElBQUksUUFBUTtBQUNoRSxNQUFNQyxzQkFBc0IsSUFBTU4sZ0RBQVMsQ0FBQ0ksUUFBUUMsR0FBRyxJQUFJLFFBQVE7QUFFbkUsK0JBQStCO0FBQy9CLE1BQU1FLFlBQVk7SUFDaEIsTUFBTUMsV0FBV047SUFFakIsSUFBSSxDQUFDSCxvREFBYSxDQUFDUyxXQUFXO1FBQzVCLE9BQU8sRUFBRTtJQUNYO0lBRUEsSUFBSTtRQUNGLE1BQU1FLE9BQU9YLHNEQUFlLENBQUNTLFVBQVU7UUFDdkMsT0FBT0ksS0FBS0MsS0FBSyxDQUFDSDtJQUNwQixFQUFFLE9BQU9JLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLHdCQUF3QkE7UUFDdEMsT0FBTyxFQUFFO0lBQ1g7QUFDRjtBQUVBLE1BQU1FLGVBQWU7SUFDbkIsTUFBTVIsV0FBV0Y7SUFFakIsSUFBSSxDQUFDUCxvREFBYSxDQUFDUyxXQUFXO1FBQzVCLE9BQU8sRUFBRTtJQUNYO0lBRUEsSUFBSTtRQUNGLE1BQU1FLE9BQU9YLHNEQUFlLENBQUNTLFVBQVU7UUFDdkMsT0FBT0ksS0FBS0MsS0FBSyxDQUFDSDtJQUNwQixFQUFFLE9BQU9JLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLDJCQUEyQkE7UUFDekMsT0FBTyxFQUFFO0lBQ1g7QUFDRjtBQUVBLE1BQU1HLGVBQWUsQ0FBQ0M7SUFDcEIsTUFBTVYsV0FBV0Y7SUFDakIsTUFBTWEsTUFBTW5CLG1EQUFZLENBQUNRO0lBRXpCLElBQUksQ0FBQ1Qsb0RBQWEsQ0FBQ29CLE1BQU07UUFDdkJwQixtREFBWSxDQUFDb0IsS0FBSztZQUFFRyxXQUFXO1FBQUs7SUFDdEM7SUFFQXZCLHVEQUFnQixDQUFDUyxVQUFVSSxLQUFLWSxTQUFTLENBQUNOLFVBQVUsTUFBTTtBQUM1RDtBQUVBLGtCQUFrQjtBQUNsQixNQUFNTyxjQUFjLENBQUNDO0lBQ25CLElBQUk7UUFDRixNQUFNQyxVQUFVMUIsMERBQVUsQ0FDeEJ5QixPQUNBdEIsUUFBUXlCLEdBQUcsQ0FBQ0MsVUFBVSxJQUFJO1FBRTVCLE9BQU9IO0lBQ1QsRUFBRSxPQUFPYixPQUFPO1FBQ2QsT0FBTztJQUNUO0FBQ0Y7QUFFQSxNQUFNaUIsbUJBQW1CLENBQUNDO0lBQ3hCLElBQUksQ0FBQ0EsY0FBYyxDQUFDQSxXQUFXQyxVQUFVLENBQUMsWUFBWTtRQUNwRCxPQUFPO0lBQ1Q7SUFFQSxNQUFNUCxRQUFRTSxXQUFXRSxLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUU7SUFDdEMsTUFBTVAsVUFBVUYsWUFBWUM7SUFFNUIsSUFBSSxDQUFDQyxTQUFTLE9BQU87SUFFckIsSUFBSTtRQUNGLE1BQU1RLFFBQVE1QjtRQUNkLE1BQU02QixPQUFPRCxNQUFNRSxJQUFJLENBQUMsQ0FBQ0MsSUFBV0EsRUFBRUMsRUFBRSxLQUFLWixRQUFRYSxNQUFNO1FBRTNELElBQUksQ0FBQ0osTUFBTSxPQUFPO1FBRWxCLE9BQU87WUFDTEcsSUFBSUgsS0FBS0csRUFBRTtZQUNYRSxVQUFVTCxLQUFLSyxRQUFRO1lBQ3ZCQyxPQUFPTixLQUFLTSxLQUFLO1lBQ2pCQyxXQUFXUCxLQUFLTyxTQUFTO1FBQzNCO0lBQ0YsRUFBRSxPQUFPN0IsT0FBTztRQUNkLE9BQU87SUFDVDtBQUNGO0FBRUEsOEJBQThCO0FBQzlCLE1BQU04Qix3QkFBd0IsQ0FBQ1I7SUFDN0IsT0FBTztRQUNMRyxJQUFJSCxLQUFLRyxFQUFFO1FBQ1hHLE9BQU9OLEtBQUtNLEtBQUs7UUFDakJHLE1BQU1ULEtBQUtLLFFBQVEsSUFBSUwsS0FBS1MsSUFBSSxJQUFJO1FBQ3BDSixVQUFVTCxLQUFLSyxRQUFRO1FBQ3ZCSyxlQUFlO1lBQ2JKLE9BQU87WUFDUEssTUFBTTtZQUNOQyxVQUFVO1lBQ1ZDLGFBQWE7WUFDYkMsVUFBVTtZQUNWQyxXQUFXO1FBQ2I7UUFDQUMsU0FBUztZQUNQQyxtQkFBbUI7WUFDbkJDLFdBQVc7WUFDWEMsV0FBVztZQUNYQyxvQkFBb0I7UUFDdEI7UUFDQUMsYUFBYTtZQUNYQyxPQUFPO1lBQ1BDLFVBQVU7WUFDVkMsVUFBVTtZQUNWQyxVQUFVO1FBQ1o7UUFDQWxCLFdBQVdQLEtBQUtPLFNBQVMsSUFBSSxJQUFJbUIsT0FBT0MsV0FBVztJQUNyRDtBQUNGO0FBRWUsZUFBZUMsUUFBUUMsR0FBbUIsRUFBRUMsR0FBb0I7SUFDN0UsTUFBTSxFQUFFQyxNQUFNLEVBQUUsR0FBR0Y7SUFFbkIsMkJBQTJCO0lBQzNCLE1BQU1HLGNBQWNyQyxpQkFBaUJrQyxJQUFJSSxPQUFPLENBQUNDLGFBQWE7SUFFOUQsSUFBSSxDQUFDRixhQUFhO1FBQ2hCLE9BQU9GLElBQUlLLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFDMUIxRCxPQUFPO1lBQ1AyRCxTQUFTO1FBQ1g7SUFDRjtJQUVBLElBQUlOLFdBQVcsT0FBTztRQUNwQixJQUFJO1lBQ0Ysc0JBQXNCO1lBQ3RCLE1BQU1PLGNBQWMxRDtZQUNwQixJQUFJMkQsZUFBZUQsWUFBWXJDLElBQUksQ0FBQ25CLENBQUFBLFdBQVlBLFNBQVNxQixFQUFFLEtBQUs2QixZQUFZN0IsRUFBRTtZQUU5RSx1Q0FBdUM7WUFDdkMsSUFBSSxDQUFDb0MsY0FBYztnQkFDakJBLGVBQWUvQixzQkFBc0J3QjtnQkFDckNNLFlBQVkzQixJQUFJLENBQUM0QjtnQkFDakIxRCxhQUFheUQ7WUFDZjtZQUVBUixJQUFJSyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDRztRQUV2QixFQUFFLE9BQU83RCxPQUFPO1lBQ2RDLFFBQVFELEtBQUssQ0FBQyx1QkFBdUJBO1lBQ3JDb0QsSUFBSUssTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFDbkIxRCxPQUFPO2dCQUNQMkQsU0FBUztZQUNYO1FBQ0Y7SUFFRixPQUFPLElBQUlOLFdBQVcsT0FBTztRQUMzQixJQUFJO1lBQ0Ysc0JBQXNCO1lBQ3RCLE1BQU1TLFVBQVVYLElBQUlZLElBQUk7WUFDeEIsTUFBTUgsY0FBYzFEO1lBQ3BCLE1BQU04RCxnQkFBZ0JKLFlBQVlLLFNBQVMsQ0FBQzdELENBQUFBLFdBQVlBLFNBQVNxQixFQUFFLEtBQUs2QixZQUFZN0IsRUFBRTtZQUV0RixzREFBc0Q7WUFDdEQsSUFBSXFDLFFBQVFuQyxRQUFRLEVBQUU7Z0JBQ3BCLE1BQU1OLFFBQVE1QjtnQkFDZCxNQUFNeUUsZUFBZTdDLE1BQU1FLElBQUksQ0FBQyxDQUFDQyxJQUMvQkEsRUFBRUcsUUFBUSxLQUFLbUMsUUFBUW5DLFFBQVEsQ0FBQ3dDLFdBQVcsTUFBTTNDLEVBQUVDLEVBQUUsS0FBSzZCLFlBQVk3QixFQUFFO2dCQUcxRSxJQUFJeUMsY0FBYztvQkFDaEIsT0FBT2QsSUFBSUssTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQzt3QkFDMUIxRCxPQUFPO3dCQUNQMkQsU0FBUztvQkFDWDtnQkFDRjtZQUNGO1lBRUEsSUFBSUssa0JBQWtCLENBQUMsR0FBRztnQkFDeEIsNkNBQTZDO2dCQUM3QyxNQUFNSSxjQUFjO29CQUNsQixHQUFHdEMsc0JBQXNCd0IsWUFBWTtvQkFDckMsR0FBR1EsT0FBTztvQkFDVnJDLElBQUk2QixZQUFZN0IsRUFBRTtvQkFDbEJHLE9BQU8wQixZQUFZMUIsS0FBSztvQkFDeEJ5QyxXQUFXLElBQUlyQixPQUFPQyxXQUFXO2dCQUNuQztnQkFDQVcsWUFBWTNCLElBQUksQ0FBQ21DO2dCQUNqQmpFLGFBQWF5RDtnQkFFYixPQUFPUixJQUFJSyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDVTtZQUM5QixPQUFPO2dCQUNMLG1DQUFtQztnQkFDbkNSLFdBQVcsQ0FBQ0ksY0FBYyxHQUFHO29CQUMzQixHQUFHSixXQUFXLENBQUNJLGNBQWM7b0JBQzdCLEdBQUdGLE9BQU87b0JBQ1ZyQyxJQUFJNkIsWUFBWTdCLEVBQUU7b0JBQ2xCRyxPQUFPMEIsWUFBWTFCLEtBQUs7b0JBQ3hCeUMsV0FBVyxJQUFJckIsT0FBT0MsV0FBVztnQkFDbkM7Z0JBRUE5QyxhQUFheUQ7Z0JBRWIsaUVBQWlFO2dCQUNqRSxJQUFJRSxRQUFRbkMsUUFBUSxJQUFJbUMsUUFBUW5DLFFBQVEsS0FBSzJCLFlBQVkzQixRQUFRLEVBQUU7b0JBQ2pFLE1BQU1OLFFBQVE1QjtvQkFDZCxNQUFNNkUsWUFBWWpELE1BQU00QyxTQUFTLENBQUMsQ0FBQ3pDLElBQVdBLEVBQUVDLEVBQUUsS0FBSzZCLFlBQVk3QixFQUFFO29CQUNyRSxJQUFJNkMsY0FBYyxDQUFDLEdBQUc7d0JBQ3BCakQsS0FBSyxDQUFDaUQsVUFBVSxDQUFDM0MsUUFBUSxHQUFHbUMsUUFBUW5DLFFBQVEsQ0FBQ3dDLFdBQVc7d0JBQ3hELE1BQU1JLGdCQUFnQm5GO3dCQUN0QkgsdURBQWdCLENBQUNzRixlQUFlekUsS0FBS1ksU0FBUyxDQUFDVyxPQUFPLE1BQU07b0JBQzlEO2dCQUNGO2dCQUVBK0IsSUFBSUssTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQ0UsV0FBVyxDQUFDSSxjQUFjO1lBQ2pEO1FBRUYsRUFBRSxPQUFPaEUsT0FBTztZQUNkQyxRQUFRRCxLQUFLLENBQUMsMEJBQTBCQTtZQUN4Q29ELElBQUlLLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQ25CMUQsT0FBTztnQkFDUDJELFNBQVM7WUFDWDtRQUNGO0lBRUYsT0FBTyxJQUFJTixXQUFXLFVBQVU7UUFDOUIsSUFBSTtZQUNGLCtCQUErQjtZQUMvQixNQUFNLEVBQUVtQixlQUFlLEVBQUUsR0FBR3JCLElBQUlZLElBQUk7WUFFcEMsSUFBSSxDQUFDUyxtQkFBbUJBLG9CQUFvQixxQkFBcUI7Z0JBQy9ELE9BQU9wQixJQUFJSyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO29CQUMxQjFELE9BQU87Z0JBQ1Q7WUFDRjtZQUVBLGlEQUFpRDtZQUNqRCxNQUFNMEIsU0FBUzRCLFlBQVk3QixFQUFFO1lBRTdCLHdCQUF3QjtZQUN4QixNQUFNSixRQUFRNUI7WUFDZCxNQUFNZ0YsZ0JBQWdCcEQsTUFBTXFELE1BQU0sQ0FBQyxDQUFDbEQsSUFBV0EsRUFBRUMsRUFBRSxLQUFLQztZQUN4RHpDLHVEQUFnQixDQUFDRyxvQkFBb0JVLEtBQUtZLFNBQVMsQ0FBQytELGVBQWUsTUFBTTtZQUV6RSwyQkFBMkI7WUFDM0IsTUFBTWIsY0FBYzFEO1lBQ3BCLE1BQU15RSxtQkFBbUJmLFlBQVljLE1BQU0sQ0FBQ0UsQ0FBQUEsSUFBS0EsRUFBRW5ELEVBQUUsS0FBS0M7WUFDMUR2QixhQUFhd0U7WUFFYiwrQ0FBK0M7WUFDL0MsTUFBTUUsVUFBVTNGLGdEQUFTLENBQUNJLFFBQVFDLEdBQUcsSUFBSTtZQUN6QyxNQUFNdUYsZUFBZTtnQkFDbkI7Z0JBQ0E7Z0JBQ0E7Z0JBQ0E7Z0JBQ0E7YUFDRDtZQUVEQSxhQUFhQyxPQUFPLENBQUNDLENBQUFBO2dCQUNuQixNQUFNdEYsV0FBV1IsZ0RBQVMsQ0FBQzJGLFNBQVNHO2dCQUNwQyxJQUFJL0Ysb0RBQWEsQ0FBQ1MsV0FBVztvQkFDM0IsSUFBSTt3QkFDRixNQUFNRSxPQUFPRSxLQUFLQyxLQUFLLENBQUNkLHNEQUFlLENBQUNTLFVBQVU7d0JBQ2xELElBQUl1Rjt3QkFFSixPQUFRRDs0QkFDTixLQUFLO2dDQUNIQyxlQUFlckYsS0FBSzhFLE1BQU0sQ0FBQyxDQUFDUSxPQUFjQSxLQUFLQyxTQUFTLEtBQUt6RDtnQ0FDN0Q7NEJBQ0YsS0FBSztnQ0FDSHVELGVBQWVyRixLQUFLOEUsTUFBTSxDQUFDLENBQUNRLE9BQWNBLEtBQUt4RCxNQUFNLEtBQUtBO2dDQUMxRDs0QkFDRixLQUFLO2dDQUNIdUQsZUFBZXJGLEtBQUs4RSxNQUFNLENBQUMsQ0FBQ1EsT0FDMUJBLEtBQUtFLFFBQVEsS0FBSzFELFVBQVV3RCxLQUFLRyxVQUFVLEtBQUszRDtnQ0FFbEQ7NEJBQ0YsS0FBSztnQ0FDSHVELGVBQWVyRixLQUFLOEUsTUFBTSxDQUFDLENBQUNRLE9BQWNBLEtBQUt4RCxNQUFNLEtBQUtBO2dDQUMxRDs0QkFDRjtnQ0FDRXVELGVBQWVyRixLQUFLOEUsTUFBTSxDQUFDLENBQUNRLE9BQWNBLEtBQUt6RCxFQUFFLEtBQUtDO3dCQUMxRDt3QkFFQXpDLHVEQUFnQixDQUFDUyxVQUFVSSxLQUFLWSxTQUFTLENBQUN1RSxjQUFjLE1BQU07b0JBQ2hFLEVBQUUsT0FBT2pGLE9BQU87d0JBQ2RDLFFBQVFELEtBQUssQ0FBQyxDQUFDLGVBQWUsRUFBRWdGLFNBQVMsQ0FBQyxDQUFDLEVBQUVoRjtvQkFDL0M7Z0JBQ0Y7WUFDRjtZQUVBb0QsSUFBSUssTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFDbkI0QixTQUFTO2dCQUNUM0IsU0FBUztZQUNYO1FBRUYsRUFBRSxPQUFPM0QsT0FBTztZQUNkQyxRQUFRRCxLQUFLLENBQUMseUJBQXlCQTtZQUN2Q29ELElBQUlLLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQ25CMUQsT0FBTztnQkFDUDJELFNBQVM7WUFDWDtRQUNGO0lBRUYsT0FBTztRQUNMUCxJQUFJSyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQ25CMUQsT0FBTztZQUNQMkQsU0FBUyxDQUFDLE9BQU8sRUFBRU4sT0FBTyxpQkFBaUIsQ0FBQztRQUM5QztJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90YXNrY2hhaW4tdWkvLi9wYWdlcy9hcGkvc2V0dGluZ3MudHM/YTk0MCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBwYWdlcy9hcGkvc2V0dGluZ3MudHNcclxuaW1wb3J0IHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnXHJcbmltcG9ydCBmcyBmcm9tICdmcydcclxuaW1wb3J0IHBhdGggZnJvbSAncGF0aCdcclxuaW1wb3J0IGp3dCBmcm9tICdqc29ud2VidG9rZW4nXHJcblxyXG5pbnRlcmZhY2UgVXNlclNldHRpbmdzIHtcclxuICBpZDogc3RyaW5nXHJcbiAgZW1haWw6IHN0cmluZ1xyXG4gIG5hbWU6IHN0cmluZ1xyXG4gIHVzZXJuYW1lOiBzdHJpbmdcclxuICBhdmF0YXI/OiBzdHJpbmdcclxuICBiaW8/OiBzdHJpbmdcclxuICBsb2NhdGlvbj86IHN0cmluZ1xyXG4gIHdlYnNpdGU/OiBzdHJpbmdcclxuICBnaXRodWI/OiBzdHJpbmdcclxuICB0d2l0dGVyPzogc3RyaW5nXHJcbiAgbGlua2VkaW4/OiBzdHJpbmdcclxuICBub3RpZmljYXRpb25zOiB7XHJcbiAgICBlbWFpbDogYm9vbGVhblxyXG4gICAgcHVzaDogYm9vbGVhblxyXG4gICAgbmV3VGFza3M6IGJvb2xlYW5cclxuICAgIHRhc2tVcGRhdGVzOiBib29sZWFuXHJcbiAgICBtZXNzYWdlczogYm9vbGVhblxyXG4gICAgbWFya2V0aW5nOiBib29sZWFuXHJcbiAgfVxyXG4gIHByaXZhY3k6IHtcclxuICAgIHByb2ZpbGVWaXNpYmlsaXR5OiAncHVibGljJyB8ICdwcml2YXRlJ1xyXG4gICAgc2hvd0VtYWlsOiBib29sZWFuXHJcbiAgICBzaG93U3RhdHM6IGJvb2xlYW5cclxuICAgIHNob3dDb21wbGV0ZWRUYXNrczogYm9vbGVhblxyXG4gIH1cclxuICBwcmVmZXJlbmNlczoge1xyXG4gICAgdGhlbWU6ICdsaWdodCcgfCAnZGFyaydcclxuICAgIGxhbmd1YWdlOiBzdHJpbmdcclxuICAgIHRpbWV6b25lOiBzdHJpbmdcclxuICAgIGN1cnJlbmN5OiBzdHJpbmdcclxuICB9XHJcbiAgY3JlYXRlZEF0OiBzdHJpbmdcclxuICB1cGRhdGVkQXQ/OiBzdHJpbmdcclxufVxyXG5cclxuLy8g0J/Rg9GC0Lgg0Log0YTQsNC50LvQsNC8XHJcbmNvbnN0IGdldFVzZXJzRmlsZVBhdGggPSAoKSA9PiBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ2RhdGEnLCAndXNlcnMuanNvbicpXHJcbmNvbnN0IGdldFNldHRpbmdzRmlsZVBhdGggPSAoKSA9PiBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ2RhdGEnLCAnc2V0dGluZ3MuanNvbicpXHJcblxyXG4vLyDQpNGD0L3QutGG0LjQuCDQtNC70Y8g0YDQsNCx0L7RgtGLINGBINGE0LDQudC70LDQvNC4XHJcbmNvbnN0IGxvYWRVc2VycyA9ICgpID0+IHtcclxuICBjb25zdCBmaWxlUGF0aCA9IGdldFVzZXJzRmlsZVBhdGgoKVxyXG4gIFxyXG4gIGlmICghZnMuZXhpc3RzU3luYyhmaWxlUGF0aCkpIHtcclxuICAgIHJldHVybiBbXVxyXG4gIH1cclxuICBcclxuICB0cnkge1xyXG4gICAgY29uc3QgZGF0YSA9IGZzLnJlYWRGaWxlU3luYyhmaWxlUGF0aCwgJ3V0ZjgnKVxyXG4gICAgcmV0dXJuIEpTT04ucGFyc2UoZGF0YSlcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgbG9hZGluZyB1c2VyczonLCBlcnJvcilcclxuICAgIHJldHVybiBbXVxyXG4gIH1cclxufVxyXG5cclxuY29uc3QgbG9hZFNldHRpbmdzID0gKCk6IFVzZXJTZXR0aW5nc1tdID0+IHtcclxuICBjb25zdCBmaWxlUGF0aCA9IGdldFNldHRpbmdzRmlsZVBhdGgoKVxyXG4gIFxyXG4gIGlmICghZnMuZXhpc3RzU3luYyhmaWxlUGF0aCkpIHtcclxuICAgIHJldHVybiBbXVxyXG4gIH1cclxuICBcclxuICB0cnkge1xyXG4gICAgY29uc3QgZGF0YSA9IGZzLnJlYWRGaWxlU3luYyhmaWxlUGF0aCwgJ3V0ZjgnKVxyXG4gICAgcmV0dXJuIEpTT04ucGFyc2UoZGF0YSlcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgbG9hZGluZyBzZXR0aW5nczonLCBlcnJvcilcclxuICAgIHJldHVybiBbXVxyXG4gIH1cclxufVxyXG5cclxuY29uc3Qgc2F2ZVNldHRpbmdzID0gKHNldHRpbmdzOiBVc2VyU2V0dGluZ3NbXSkgPT4ge1xyXG4gIGNvbnN0IGZpbGVQYXRoID0gZ2V0U2V0dGluZ3NGaWxlUGF0aCgpXHJcbiAgY29uc3QgZGlyID0gcGF0aC5kaXJuYW1lKGZpbGVQYXRoKVxyXG4gIFxyXG4gIGlmICghZnMuZXhpc3RzU3luYyhkaXIpKSB7XHJcbiAgICBmcy5ta2RpclN5bmMoZGlyLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KVxyXG4gIH1cclxuICBcclxuICBmcy53cml0ZUZpbGVTeW5jKGZpbGVQYXRoLCBKU09OLnN0cmluZ2lmeShzZXR0aW5ncywgbnVsbCwgMikpXHJcbn1cclxuXHJcbi8vINCf0YDQvtCy0LXRgNC60LAg0YLQvtC60LXQvdCwXHJcbmNvbnN0IHZlcmlmeVRva2VuID0gKHRva2VuOiBzdHJpbmcpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgZGVjb2RlZCA9IGp3dC52ZXJpZnkoXHJcbiAgICAgIHRva2VuLCBcclxuICAgICAgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCB8fCAnd29ya2x5LWxvY2FsLXNlY3JldC1rZXktMjAyNSdcclxuICAgICkgYXMgeyB1c2VySWQ6IHN0cmluZyB9XHJcbiAgICByZXR1cm4gZGVjb2RlZFxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXR1cm4gbnVsbFxyXG4gIH1cclxufVxyXG5cclxuY29uc3QgZ2V0VXNlckZyb21Ub2tlbiA9IChhdXRoSGVhZGVyOiBzdHJpbmcpID0+IHtcclxuICBpZiAoIWF1dGhIZWFkZXIgfHwgIWF1dGhIZWFkZXIuc3RhcnRzV2l0aCgnQmVhcmVyICcpKSB7XHJcbiAgICByZXR1cm4gbnVsbFxyXG4gIH1cclxuXHJcbiAgY29uc3QgdG9rZW4gPSBhdXRoSGVhZGVyLnNwbGl0KCcgJylbMV1cclxuICBjb25zdCBkZWNvZGVkID0gdmVyaWZ5VG9rZW4odG9rZW4pXHJcbiAgXHJcbiAgaWYgKCFkZWNvZGVkKSByZXR1cm4gbnVsbFxyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgdXNlcnMgPSBsb2FkVXNlcnMoKVxyXG4gICAgY29uc3QgdXNlciA9IHVzZXJzLmZpbmQoKHU6IGFueSkgPT4gdS5pZCA9PT0gZGVjb2RlZC51c2VySWQpXHJcbiAgICBcclxuICAgIGlmICghdXNlcikgcmV0dXJuIG51bGxcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBpZDogdXNlci5pZCxcclxuICAgICAgdXNlcm5hbWU6IHVzZXIudXNlcm5hbWUsXHJcbiAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxyXG4gICAgICBjcmVhdGVkQXQ6IHVzZXIuY3JlYXRlZEF0XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJldHVybiBudWxsXHJcbiAgfVxyXG59XHJcblxyXG4vLyDQodC+0LfQtNCw0L3QuNC1INC00LXRhNC+0LvRgtC90YvRhSDQvdCw0YHRgtGA0L7QtdC6XHJcbmNvbnN0IGNyZWF0ZURlZmF1bHRTZXR0aW5ncyA9ICh1c2VyOiBhbnkpOiBVc2VyU2V0dGluZ3MgPT4ge1xyXG4gIHJldHVybiB7XHJcbiAgICBpZDogdXNlci5pZCxcclxuICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxyXG4gICAgbmFtZTogdXNlci51c2VybmFtZSB8fCB1c2VyLm5hbWUgfHwgJycsXHJcbiAgICB1c2VybmFtZTogdXNlci51c2VybmFtZSxcclxuICAgIG5vdGlmaWNhdGlvbnM6IHtcclxuICAgICAgZW1haWw6IHRydWUsXHJcbiAgICAgIHB1c2g6IHRydWUsXHJcbiAgICAgIG5ld1Rhc2tzOiB0cnVlLFxyXG4gICAgICB0YXNrVXBkYXRlczogdHJ1ZSxcclxuICAgICAgbWVzc2FnZXM6IHRydWUsXHJcbiAgICAgIG1hcmtldGluZzogZmFsc2VcclxuICAgIH0sXHJcbiAgICBwcml2YWN5OiB7XHJcbiAgICAgIHByb2ZpbGVWaXNpYmlsaXR5OiAncHVibGljJyxcclxuICAgICAgc2hvd0VtYWlsOiBmYWxzZSxcclxuICAgICAgc2hvd1N0YXRzOiB0cnVlLFxyXG4gICAgICBzaG93Q29tcGxldGVkVGFza3M6IHRydWVcclxuICAgIH0sXHJcbiAgICBwcmVmZXJlbmNlczoge1xyXG4gICAgICB0aGVtZTogJ2RhcmsnLFxyXG4gICAgICBsYW5ndWFnZTogJ2VuJyxcclxuICAgICAgdGltZXpvbmU6ICdVVEMnLFxyXG4gICAgICBjdXJyZW5jeTogJ1VTRCdcclxuICAgIH0sXHJcbiAgICBjcmVhdGVkQXQ6IHVzZXIuY3JlYXRlZEF0IHx8IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkge1xyXG4gIGNvbnN0IHsgbWV0aG9kIH0gPSByZXFcclxuXHJcbiAgLy8g0J/RgNC+0LLQtdGA0Y/QtdC8INCw0YPRgtC10L3RgtC40YTQuNC60LDRhtC40Y5cclxuICBjb25zdCBjdXJyZW50VXNlciA9IGdldFVzZXJGcm9tVG9rZW4ocmVxLmhlYWRlcnMuYXV0aG9yaXphdGlvbilcclxuICBcclxuICBpZiAoIWN1cnJlbnRVc2VyKSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oe1xyXG4gICAgICBlcnJvcjogJ1VuYXV0aG9yaXplZCcsXHJcbiAgICAgIG1lc3NhZ2U6ICdBdXRoZW50aWNhdGlvbiByZXF1aXJlZCdcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBpZiAobWV0aG9kID09PSAnR0VUJykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgLy8g0JfQsNCz0YDRg9C20LDQtdC8INC90LDRgdGC0YDQvtC50LrQuFxyXG4gICAgICBjb25zdCBhbGxTZXR0aW5ncyA9IGxvYWRTZXR0aW5ncygpXHJcbiAgICAgIGxldCB1c2VyU2V0dGluZ3MgPSBhbGxTZXR0aW5ncy5maW5kKHNldHRpbmdzID0+IHNldHRpbmdzLmlkID09PSBjdXJyZW50VXNlci5pZClcclxuXHJcbiAgICAgIC8vINCV0YHQu9C4INC90LDRgdGC0YDQvtC10Log0L3QtdGCLCDRgdC+0LfQtNCw0LXQvCDQtNC10YTQvtC70YLQvdGL0LVcclxuICAgICAgaWYgKCF1c2VyU2V0dGluZ3MpIHtcclxuICAgICAgICB1c2VyU2V0dGluZ3MgPSBjcmVhdGVEZWZhdWx0U2V0dGluZ3MoY3VycmVudFVzZXIpXHJcbiAgICAgICAgYWxsU2V0dGluZ3MucHVzaCh1c2VyU2V0dGluZ3MpXHJcbiAgICAgICAgc2F2ZVNldHRpbmdzKGFsbFNldHRpbmdzKVxyXG4gICAgICB9XHJcblxyXG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih1c2VyU2V0dGluZ3MpXHJcblxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignR2V0IHNldHRpbmdzIGVycm9yOicsIGVycm9yKVxyXG4gICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgICAgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdGYWlsZWQgdG8gZ2V0IHNldHRpbmdzJ1xyXG4gICAgICB9KVxyXG4gICAgfVxyXG5cclxuICB9IGVsc2UgaWYgKG1ldGhvZCA9PT0gJ1BVVCcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vINCe0LHQvdC+0LLQu9GP0LXQvCDQvdCw0YHRgtGA0L7QudC60LhcclxuICAgICAgY29uc3QgdXBkYXRlcyA9IHJlcS5ib2R5XHJcbiAgICAgIGNvbnN0IGFsbFNldHRpbmdzID0gbG9hZFNldHRpbmdzKClcclxuICAgICAgY29uc3Qgc2V0dGluZ3NJbmRleCA9IGFsbFNldHRpbmdzLmZpbmRJbmRleChzZXR0aW5ncyA9PiBzZXR0aW5ncy5pZCA9PT0gY3VycmVudFVzZXIuaWQpXHJcblxyXG4gICAgICAvLyDQktCw0LvQuNC00LDRhtC40Y8gdXNlcm5hbWUg0L3QsCDRg9C90LjQutCw0LvRjNC90L7RgdGC0YwgKNC10YHQu9C4INC40LfQvNC10L3QuNC70YHRjylcclxuICAgICAgaWYgKHVwZGF0ZXMudXNlcm5hbWUpIHtcclxuICAgICAgICBjb25zdCB1c2VycyA9IGxvYWRVc2VycygpXHJcbiAgICAgICAgY29uc3QgZXhpc3RpbmdVc2VyID0gdXNlcnMuZmluZCgodTogYW55KSA9PiBcclxuICAgICAgICAgIHUudXNlcm5hbWUgPT09IHVwZGF0ZXMudXNlcm5hbWUudG9Mb3dlckNhc2UoKSAmJiB1LmlkICE9PSBjdXJyZW50VXNlci5pZFxyXG4gICAgICAgIClcclxuICAgICAgICBcclxuICAgICAgICBpZiAoZXhpc3RpbmdVc2VyKSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBcclxuICAgICAgICAgICAgZXJyb3I6ICdVc2VybmFtZSBhbHJlYWR5IHRha2VuJyxcclxuICAgICAgICAgICAgbWVzc2FnZTogJ1RoaXMgdXNlcm5hbWUgaXMgYWxyZWFkeSBpbiB1c2UgYnkgYW5vdGhlciB1c2VyJ1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChzZXR0aW5nc0luZGV4ID09PSAtMSkge1xyXG4gICAgICAgIC8vINCh0L7Qt9C00LDQtdC8INC90L7QstGL0LUg0L3QsNGB0YLRgNC+0LnQutC4INC10YHQu9C4INC90LUg0YHRg9GJ0LXRgdGC0LLRg9GO0YJcclxuICAgICAgICBjb25zdCBuZXdTZXR0aW5ncyA9IHtcclxuICAgICAgICAgIC4uLmNyZWF0ZURlZmF1bHRTZXR0aW5ncyhjdXJyZW50VXNlciksXHJcbiAgICAgICAgICAuLi51cGRhdGVzLFxyXG4gICAgICAgICAgaWQ6IGN1cnJlbnRVc2VyLmlkLCAvLyDQl9Cw0YnQuNGJ0LDQtdC8INC+0YIg0LjQt9C80LXQvdC10L3QuNGPIElEXHJcbiAgICAgICAgICBlbWFpbDogY3VycmVudFVzZXIuZW1haWwsIC8vINCX0LDRidC40YnQsNC10Lwg0L7RgiDQuNC30LzQtdC90LXQvdC40Y8gZW1haWxcclxuICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGFsbFNldHRpbmdzLnB1c2gobmV3U2V0dGluZ3MpXHJcbiAgICAgICAgc2F2ZVNldHRpbmdzKGFsbFNldHRpbmdzKVxyXG5cclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDEpLmpzb24obmV3U2V0dGluZ3MpXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8g0J7QsdC90L7QstC70Y/QtdC8INGB0YPRidC10YHRgtCy0YPRjtGJ0LjQtSDQvdCw0YHRgtGA0L7QudC60LhcclxuICAgICAgICBhbGxTZXR0aW5nc1tzZXR0aW5nc0luZGV4XSA9IHtcclxuICAgICAgICAgIC4uLmFsbFNldHRpbmdzW3NldHRpbmdzSW5kZXhdLFxyXG4gICAgICAgICAgLi4udXBkYXRlcyxcclxuICAgICAgICAgIGlkOiBjdXJyZW50VXNlci5pZCwgLy8g0JfQsNGJ0LjRidCw0LXQvCDQvtGCINC40LfQvNC10L3QtdC90LjRjyBJRFxyXG4gICAgICAgICAgZW1haWw6IGN1cnJlbnRVc2VyLmVtYWlsLCAvLyDQl9Cw0YnQuNGJ0LDQtdC8INC+0YIg0LjQt9C80LXQvdC10L3QuNGPIGVtYWlsXHJcbiAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgc2F2ZVNldHRpbmdzKGFsbFNldHRpbmdzKVxyXG5cclxuICAgICAgICAvLyDQldGB0LvQuCDQvtCx0L3QvtCy0LjQu9GB0Y8gdXNlcm5hbWUsINC90YPQttC90L4g0YLQsNC60LbQtSDQvtCx0L3QvtCy0LjRgtGMINC10LPQviDQsiB1c2Vycy5qc29uXHJcbiAgICAgICAgaWYgKHVwZGF0ZXMudXNlcm5hbWUgJiYgdXBkYXRlcy51c2VybmFtZSAhPT0gY3VycmVudFVzZXIudXNlcm5hbWUpIHtcclxuICAgICAgICAgIGNvbnN0IHVzZXJzID0gbG9hZFVzZXJzKClcclxuICAgICAgICAgIGNvbnN0IHVzZXJJbmRleCA9IHVzZXJzLmZpbmRJbmRleCgodTogYW55KSA9PiB1LmlkID09PSBjdXJyZW50VXNlci5pZClcclxuICAgICAgICAgIGlmICh1c2VySW5kZXggIT09IC0xKSB7XHJcbiAgICAgICAgICAgIHVzZXJzW3VzZXJJbmRleF0udXNlcm5hbWUgPSB1cGRhdGVzLnVzZXJuYW1lLnRvTG93ZXJDYXNlKClcclxuICAgICAgICAgICAgY29uc3QgdXNlcnNGaWxlUGF0aCA9IGdldFVzZXJzRmlsZVBhdGgoKVxyXG4gICAgICAgICAgICBmcy53cml0ZUZpbGVTeW5jKHVzZXJzRmlsZVBhdGgsIEpTT04uc3RyaW5naWZ5KHVzZXJzLCBudWxsLCAyKSlcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKGFsbFNldHRpbmdzW3NldHRpbmdzSW5kZXhdKVxyXG4gICAgICB9XHJcblxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignVXBkYXRlIHNldHRpbmdzIGVycm9yOicsIGVycm9yKVxyXG4gICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgICAgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdGYWlsZWQgdG8gdXBkYXRlIHNldHRpbmdzJ1xyXG4gICAgICB9KVxyXG4gICAgfVxyXG5cclxuICB9IGVsc2UgaWYgKG1ldGhvZCA9PT0gJ0RFTEVURScpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vINCj0LTQsNC70LjRgtGMINCw0LrQutCw0YPQvdGCINC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRj1xyXG4gICAgICBjb25zdCB7IGNvbmZpcm1QYXNzd29yZCB9ID0gcmVxLmJvZHlcclxuXHJcbiAgICAgIGlmICghY29uZmlybVBhc3N3b3JkIHx8IGNvbmZpcm1QYXNzd29yZCAhPT0gJ0RFTEVURV9NWV9BQ0NPVU5UJykge1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IFxyXG4gICAgICAgICAgZXJyb3I6ICdQbGVhc2UgdHlwZSBcIkRFTEVURV9NWV9BQ0NPVU5UXCIgdG8gY29uZmlybSBhY2NvdW50IGRlbGV0aW9uJyBcclxuICAgICAgICB9KVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyDQo9C00LDQu9GP0LXQvCDQstGB0LUg0LTQsNC90L3Ri9C1INC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjyDQuNC3INCy0YHQtdGFINGE0LDQudC70L7QslxyXG4gICAgICBjb25zdCB1c2VySWQgPSBjdXJyZW50VXNlci5pZFxyXG5cclxuICAgICAgLy8g0KPQtNCw0LvRj9C10Lwg0LjQtyB1c2Vycy5qc29uXHJcbiAgICAgIGNvbnN0IHVzZXJzID0gbG9hZFVzZXJzKClcclxuICAgICAgY29uc3QgZmlsdGVyZWRVc2VycyA9IHVzZXJzLmZpbHRlcigodTogYW55KSA9PiB1LmlkICE9PSB1c2VySWQpXHJcbiAgICAgIGZzLndyaXRlRmlsZVN5bmMoZ2V0VXNlcnNGaWxlUGF0aCgpLCBKU09OLnN0cmluZ2lmeShmaWx0ZXJlZFVzZXJzLCBudWxsLCAyKSlcclxuXHJcbiAgICAgIC8vINCj0LTQsNC70Y/QtdC8INC40Lcgc2V0dGluZ3MuanNvblxyXG4gICAgICBjb25zdCBhbGxTZXR0aW5ncyA9IGxvYWRTZXR0aW5ncygpXHJcbiAgICAgIGNvbnN0IGZpbHRlcmVkU2V0dGluZ3MgPSBhbGxTZXR0aW5ncy5maWx0ZXIocyA9PiBzLmlkICE9PSB1c2VySWQpXHJcbiAgICAgIHNhdmVTZXR0aW5ncyhmaWx0ZXJlZFNldHRpbmdzKVxyXG5cclxuICAgICAgLy8g0KPQtNCw0LvRj9C10Lwg0LjQtyDQtNGA0YPQs9C40YUg0YTQsNC50LvQvtCyINC10YHQu9C4INC+0L3QuCDRgdGD0YnQtdGB0YLQstGD0Y7RglxyXG4gICAgICBjb25zdCBkYXRhRGlyID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksICdkYXRhJylcclxuICAgICAgY29uc3QgZmlsZXNUb0NoZWNrID0gW1xyXG4gICAgICAgICdwcm9maWxlcy5qc29uJyxcclxuICAgICAgICAndGFza3MuanNvbicsXHJcbiAgICAgICAgJ2FwcGxpY2F0aW9ucy5qc29uJyxcclxuICAgICAgICAnbWVzc2FnZXMuanNvbicsXHJcbiAgICAgICAgJ25vdGlmaWNhdGlvbnMuanNvbidcclxuICAgICAgXVxyXG5cclxuICAgICAgZmlsZXNUb0NoZWNrLmZvckVhY2goZmlsZU5hbWUgPT4ge1xyXG4gICAgICAgIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5qb2luKGRhdGFEaXIsIGZpbGVOYW1lKVxyXG4gICAgICAgIGlmIChmcy5leGlzdHNTeW5jKGZpbGVQYXRoKSkge1xyXG4gICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKGZpbGVQYXRoLCAndXRmOCcpKVxyXG4gICAgICAgICAgICBsZXQgZmlsdGVyZWREYXRhXHJcblxyXG4gICAgICAgICAgICBzd2l0Y2ggKGZpbGVOYW1lKSB7XHJcbiAgICAgICAgICAgICAgY2FzZSAndGFza3MuanNvbic6XHJcbiAgICAgICAgICAgICAgICBmaWx0ZXJlZERhdGEgPSBkYXRhLmZpbHRlcigoaXRlbTogYW55KSA9PiBpdGVtLmNyZWF0ZWRCeSAhPT0gdXNlcklkKVxyXG4gICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICBjYXNlICdhcHBsaWNhdGlvbnMuanNvbic6XHJcbiAgICAgICAgICAgICAgICBmaWx0ZXJlZERhdGEgPSBkYXRhLmZpbHRlcigoaXRlbTogYW55KSA9PiBpdGVtLnVzZXJJZCAhPT0gdXNlcklkKVxyXG4gICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICBjYXNlICdtZXNzYWdlcy5qc29uJzpcclxuICAgICAgICAgICAgICAgIGZpbHRlcmVkRGF0YSA9IGRhdGEuZmlsdGVyKChpdGVtOiBhbnkpID0+IFxyXG4gICAgICAgICAgICAgICAgICBpdGVtLnNlbmRlcklkICE9PSB1c2VySWQgJiYgaXRlbS5yZWNlaXZlcklkICE9PSB1c2VySWRcclxuICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgY2FzZSAnbm90aWZpY2F0aW9ucy5qc29uJzpcclxuICAgICAgICAgICAgICAgIGZpbHRlcmVkRGF0YSA9IGRhdGEuZmlsdGVyKChpdGVtOiBhbnkpID0+IGl0ZW0udXNlcklkICE9PSB1c2VySWQpXHJcbiAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBmaWx0ZXJlZERhdGEgPSBkYXRhLmZpbHRlcigoaXRlbTogYW55KSA9PiBpdGVtLmlkICE9PSB1c2VySWQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZzLndyaXRlRmlsZVN5bmMoZmlsZVBhdGgsIEpTT04uc3RyaW5naWZ5KGZpbHRlcmVkRGF0YSwgbnVsbCwgMikpXHJcbiAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBjbGVhbmluZyAke2ZpbGVOYW1lfTpgLCBlcnJvcilcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcblxyXG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IFxyXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgbWVzc2FnZTogJ0FjY291bnQgZGVsZXRlZCBzdWNjZXNzZnVsbHknIFxyXG4gICAgICB9KVxyXG5cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0RlbGV0ZSBhY2NvdW50IGVycm9yOicsIGVycm9yKVxyXG4gICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgICAgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdGYWlsZWQgdG8gZGVsZXRlIGFjY291bnQnXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gIH0gZWxzZSB7XHJcbiAgICByZXMuc3RhdHVzKDQwNSkuanNvbih7IFxyXG4gICAgICBlcnJvcjogJ01ldGhvZCBub3QgYWxsb3dlZCcsXHJcbiAgICAgIG1lc3NhZ2U6IGBNZXRob2QgJHttZXRob2R9IGlzIG5vdCBzdXBwb3J0ZWRgXHJcbiAgICB9KVxyXG4gIH1cclxufSJdLCJuYW1lcyI6WyJmcyIsInBhdGgiLCJqd3QiLCJnZXRVc2Vyc0ZpbGVQYXRoIiwiam9pbiIsInByb2Nlc3MiLCJjd2QiLCJnZXRTZXR0aW5nc0ZpbGVQYXRoIiwibG9hZFVzZXJzIiwiZmlsZVBhdGgiLCJleGlzdHNTeW5jIiwiZGF0YSIsInJlYWRGaWxlU3luYyIsIkpTT04iLCJwYXJzZSIsImVycm9yIiwiY29uc29sZSIsImxvYWRTZXR0aW5ncyIsInNhdmVTZXR0aW5ncyIsInNldHRpbmdzIiwiZGlyIiwiZGlybmFtZSIsIm1rZGlyU3luYyIsInJlY3Vyc2l2ZSIsIndyaXRlRmlsZVN5bmMiLCJzdHJpbmdpZnkiLCJ2ZXJpZnlUb2tlbiIsInRva2VuIiwiZGVjb2RlZCIsInZlcmlmeSIsImVudiIsIkpXVF9TRUNSRVQiLCJnZXRVc2VyRnJvbVRva2VuIiwiYXV0aEhlYWRlciIsInN0YXJ0c1dpdGgiLCJzcGxpdCIsInVzZXJzIiwidXNlciIsImZpbmQiLCJ1IiwiaWQiLCJ1c2VySWQiLCJ1c2VybmFtZSIsImVtYWlsIiwiY3JlYXRlZEF0IiwiY3JlYXRlRGVmYXVsdFNldHRpbmdzIiwibmFtZSIsIm5vdGlmaWNhdGlvbnMiLCJwdXNoIiwibmV3VGFza3MiLCJ0YXNrVXBkYXRlcyIsIm1lc3NhZ2VzIiwibWFya2V0aW5nIiwicHJpdmFjeSIsInByb2ZpbGVWaXNpYmlsaXR5Iiwic2hvd0VtYWlsIiwic2hvd1N0YXRzIiwic2hvd0NvbXBsZXRlZFRhc2tzIiwicHJlZmVyZW5jZXMiLCJ0aGVtZSIsImxhbmd1YWdlIiwidGltZXpvbmUiLCJjdXJyZW5jeSIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJjdXJyZW50VXNlciIsImhlYWRlcnMiLCJhdXRob3JpemF0aW9uIiwic3RhdHVzIiwianNvbiIsIm1lc3NhZ2UiLCJhbGxTZXR0aW5ncyIsInVzZXJTZXR0aW5ncyIsInVwZGF0ZXMiLCJib2R5Iiwic2V0dGluZ3NJbmRleCIsImZpbmRJbmRleCIsImV4aXN0aW5nVXNlciIsInRvTG93ZXJDYXNlIiwibmV3U2V0dGluZ3MiLCJ1cGRhdGVkQXQiLCJ1c2VySW5kZXgiLCJ1c2Vyc0ZpbGVQYXRoIiwiY29uZmlybVBhc3N3b3JkIiwiZmlsdGVyZWRVc2VycyIsImZpbHRlciIsImZpbHRlcmVkU2V0dGluZ3MiLCJzIiwiZGF0YURpciIsImZpbGVzVG9DaGVjayIsImZvckVhY2giLCJmaWxlTmFtZSIsImZpbHRlcmVkRGF0YSIsIml0ZW0iLCJjcmVhdGVkQnkiLCJzZW5kZXJJZCIsInJlY2VpdmVySWQiLCJzdWNjZXNzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/settings.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("(api)/./pages/api/settings.ts"));
module.exports = __webpack_exports__;

})();